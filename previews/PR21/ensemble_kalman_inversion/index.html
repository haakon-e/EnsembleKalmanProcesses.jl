<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Ensemble Kalman Inversion · EnsembleKalmanProcesses.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">EnsembleKalmanProcesses.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../installation_instructions/">Installation instructions</a></li><li><a class="tocitem" href="../parameter_distributions/">Prior distributions</a></li><li><a class="tocitem" href="../observations/">Observations</a></li><li class="is-active"><a class="tocitem" href>Ensemble Kalman Inversion</a></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/template_example/">Template example</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">API</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../API/EnsembleKalmanProcessModule/">EnsembleKalmanProcessModule</a></li><li><a class="tocitem" href="../API/ParameterDistribution/">ParameterDistribution</a></li><li><a class="tocitem" href="../API/Observations/">Observations</a></li><li><a class="tocitem" href="../API/DataStorage/">DataStorage</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Ensemble Kalman Inversion</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Ensemble Kalman Inversion</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/CliMA/EnsembleKalmanProcesses.jl/blob/master/docs/src/ensemble_kalman_inversion.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Ensemble-Kalman-Inversion"><a class="docs-heading-anchor" href="#Ensemble-Kalman-Inversion">Ensemble Kalman Inversion</a><a id="Ensemble-Kalman-Inversion-1"></a><a class="docs-heading-anchor-permalink" href="#Ensemble-Kalman-Inversion" title="Permalink"></a></h1><p>One of the ensemble Kalman processes implemented in <code>EnsembleKalmanProcesses.jl</code> is the ensemble Kalman inversion (<a href="http://dx.doi.org/10.1088/0266-5611/29/4/045001">Iglesias et al, 2013</a>). The ensemble Kalman inversion is a derivative-free optimization method that seeks to find the optimal parameter \( \theta \in R^m \) in the inverse problem</p><p>\[ y = G(\theta) + \eta, \]</p><p>where <span>$G$</span> denotes the forward map and <span>$\eta$</span> is additive observational noise. The obtained solution is optimal in the sense of the mean squared error loss.</p><p>An ensemble Kalman inversion object can be created using the <code>EnsembleKalmanProcess</code> constructor by specifying the <code>Inversion()</code> process type.</p><p>Creating an ensemble Kalman inversion object requires as arguments:</p><ol><li>An initial parameter ensemble, <code>Array{FT, 2}</code> of size <code>[parameter_dim × N_ens]</code>;</li><li>The mean value of the observed outputs, a vector of the observed vector size <code>[data_dim]</code>;</li><li>The covariance matrix of the observational noise, of size <code>[data_dim × data_dim]</code></li><li>The <code>Inversion()</code> process type.</li></ol><p>A typical initialization of the <code>Inversion()</code> process may be in terms of a user-defined <code>prior</code>, a summary of the observation statistics given by the mean <code>obs_mean</code> and covariance <code>obs_noise_cov</code>, and a desired number of elements in the ensemble,</p><pre><code class="language-julia">using EnsembleKalmanProcesses.EnsembleKalmanProcessModule
using EnsembleKalmanProcesses.ParameterDistributionStorage

N_ens = 50  # number of ensemble members
initial_ensemble = construct_initial_ensemble(prior, N_ens) # Initialize ensemble from prior

ekiobj = EnsembleKalmanProcess(initial_ensemble, obs_mean, obs_noise_cov, Inversion())</code></pre><p>Note that no information about the forward model is necessary to initialize the Inversion process. The only forward model information required by the inversion process consists of model evaluations at the ensemble elements, necessary to update the ensemble.</p><h3 id="Updating-the-Ensemble"><a class="docs-heading-anchor" href="#Updating-the-Ensemble">Updating the Ensemble</a><a id="Updating-the-Ensemble-1"></a><a class="docs-heading-anchor-permalink" href="#Updating-the-Ensemble" title="Permalink"></a></h3><p>Once the ensemble Kalman inversion object <code>ekiobj</code> has been initialized, any number of updates can be performed using the inversion algorithm.</p><p>A call to the inversion algorithm can be performed with the <code>update_ensemble!</code> function. This function takes as arguments the <code>ekiobj</code> and the evaluations of the forward model at each element of the current ensemble. The <code>update_ensemble!</code> function then stores the new updated ensemble and the inputted forward model evaluations in <code>ekiobj</code>.</p><p>A typical use of the <code>update_ensemble!</code> function given the ensemble Kalman inversion object <code>ekiobj</code> and the forward model <code>G</code> is</p><pre><code class="language-julia">N_iter = 20 # Number of steps of the algorithm

for i in 1:N_iter
    params_i = get_u_final(ekiobj) # Get current ensemble
    g_ens = hcat([G(params_i[:,i]) for i in 1:N_ens]...) # Evaluate forward model
    update_ensemble!(ekiobj, g_ens) # Update ensemble
end</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../observations/">« Observations</a><a class="docs-footer-nextpage" href="../examples/template_example/">Template example »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Saturday 17 April 2021 00:39">Saturday 17 April 2021</span>. Using Julia version 1.5.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
